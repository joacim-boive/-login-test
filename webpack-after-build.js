const fse = require('fs-extra');

const cordovaDir = 'cordova/www';
const resourcesDir = 'build/static';
const now = new Date()
    .toISOString()
    .substring(0, 19)
    .replace('T', ' ');

console.log();
console.log('webpack-after-build STARTING');

console.log(`- cleaning target dir ${cordovaDir}/static`);
fse.removeSync(`${cordovaDir}/static`);
fse.mkdirsSync(`${cordovaDir}/static`);

console.log('- copying built files');
fse.copySync(resourcesDir, `${cordovaDir}/static`);
fse.writeFile(
    `${`${cordovaDir}/static`}/0-README.txt`,
    `All files generated by build ${now}. Don't edit or add to git!`
);
fse.appendFile(`${cordovaDir}/index.html`, `<!-- File generated by build ${now}. Don't edit or add to git! -->`);

console.log('webpack-after-build DONE');
